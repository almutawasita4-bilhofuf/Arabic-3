<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ŸÖÿ±ÿßÿ¨ÿπÿ© ÿπÿßŸÖÿ© ŸÑŸÑÿµŸÅ 3ŸÖ ŸÅ1 ÿßŸÑŸÑÿ∫ÿ© ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</title>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-start: #0f766e;
            --primary-end: #14b8a6;
            --card-bg: #ffffff;
            --correct-color: #059669;
            --incorrect-color: #dc2626;
            --text-main: #1e293b;
            --bg-gradient: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Tajawal', sans-serif;
            background: var(--bg-gradient);
            min-height: 100vh;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding-bottom: 100px;
            color: var(--text-main);
        }

        /* ÿ™ŸÜÿ≥ŸäŸÇÿßÿ™ ÿßŸÑÿ±ÿ£ÿ≥ ŸàÿßŸÑÿ¥ÿπÿßÿ± */
        .header {
            text-align: center;
            margin-bottom: 30px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            background: rgba(255, 255, 255, 0.6);
            padding: 20px;
            border-radius: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            width: 100%;
            max-width: 800px;
        }

        .header img {
            width: 100px; /* ÿ≠ÿ¨ŸÖ ÿßŸÑÿ¥ÿπÿßÿ± */
            height: auto;
            margin-bottom: 5px;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1));
        }

        .header h1 {
            font-size: 1.8rem;
            color: #0f766e;
            margin: 0;
            line-height: 1.4;
        }

        .school-name {
            font-size: 1.2rem;
            color: #334155;
            font-weight: 700;
            margin-top: 5px;
            border-top: 2px solid #e2e8f0;
            padding-top: 10px;
            width: 80%;
        }

        /* Mode Selection */
        .mode-selection {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            background: white;
            padding: 5px;
            border-radius: 50px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        .mode-btn {
            background: transparent;
            border: none;
            color: #64748b;
            padding: 10px 25px;
            border-radius: 50px;
            cursor: pointer;
            font-weight: bold;
            font-family: 'Tajawal', sans-serif;
            transition: all 0.3s;
        }

        .mode-btn.active {
            background: var(--primary-start);
            color: white;
            box-shadow: 0 4px 6px -1px rgba(15, 118, 110, 0.4);
        }

        .controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            width: 100%;
            position: fixed;
            bottom: 0;
            left: 0;
            background: rgba(255,255,255,0.9);
            padding: 15px;
            z-index: 100;
            backdrop-filter: blur(10px);
            border-top: 1px solid #e2e8f0;
        }

        .btn {
            background: var(--primary-start);
            color: white;
            border: none;
            padding: 12px 35px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: bold;
            font-family: 'Tajawal', sans-serif;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 15px rgba(0,0,0,0.15);
        }

        .btn-reset {
            background: #94a3b8;
        }

        /* Cards Container */
        .cards-container {
            display: flex;
            flex-direction: column;
            gap: 25px;
            max-width: 800px;
            width: 100%;
            padding: 10px;
        }

        .card {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            border: 1px solid #e2e8f0;
            position: relative;
            overflow: hidden;
        }

        .section-badge {
            display: inline-block;
            background: #f0fdfa;
            color: var(--primary-start);
            padding: 5px 12px;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: bold;
            margin-bottom: 15px;
            border: 1px solid #ccfbf1;
        }

        /* Context Box (The Piece/Poem) */
        .context-box {
            background: #f8fafc;
            border-right: 4px solid var(--primary-start);
            padding: 15px 20px;
            border-radius: 8px;
            margin-bottom: 25px;
            font-size: 1.1rem;
            line-height: 1.8;
            color: #334155;
            white-space: pre-line;
            font-weight: 600;
        }

        .sub-question {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px dashed #e2e8f0;
        }
        
        .sub-question:first-of-type {
            margin-top: 0;
            padding-top: 0;
            border-top: none;
        }

        .question-text {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--text-main);
            margin-bottom: 15px;
        }

        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr; /* ÿπŸÖŸàÿØŸäŸÜ */
            gap: 12px;
        }

        .option-btn {
            background: white;
            border: 2px solid #e2e8f0;
            padding: 12px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 1rem;
            font-family: 'Tajawal', sans-serif;
            text-align: center;
            transition: all 0.2s;
            color: #64748b;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 55px;
        }

        .option-btn:hover {
            border-color: var(--primary-start);
            background: #f0fdfa;
        }

        .option-btn.selected {
            background: var(--primary-start);
            color: white;
            border-color: var(--primary-start);
        }

        .option-btn.correct-ans {
            background: var(--correct-color) !important;
            color: white !important;
            border-color: var(--correct-color) !important;
        }

        .option-btn.wrong-ans {
            background: var(--incorrect-color) !important;
            color: white !important;
            border-color: var(--incorrect-color) !important;
        }

        .feedback-msg {
            margin-top: 10px;
            font-weight: bold;
            font-size: 1rem;
            display: none;
            padding: 8px;
            border-radius: 6px;
            text-align: center;
        }

        /* Result Popup */
        .overlay {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 999;
            display: none;
            backdrop-filter: blur(5px);
        }

        .stats-popup {
            position: fixed;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 40px;
            border-radius: 24px;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
            text-align: center;
            z-index: 1000;
            display: none;
            width: 90%;
            max-width: 450px;
        }

        .score-circle {
            width: 140px; height: 140px;
            background: var(--primary-start);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            font-weight: 800;
            margin: 0 auto 20px;
            border: 6px solid #ccfbf1;
        }

        @media (max-width: 600px) {
            .header h1 { font-size: 1.5rem; }
            .card { padding: 15px; }
            .options-grid { gap: 10px; }
        }
    </style>
</head>
<body>

    <div class="header">
        <img src="https://z-cdn-media.chatglm.cn/files/18831501-6f8f-4284-a7e3-2b5f219a8b9d_%D8%B4%D8%B9%D8%A7%D8%B1%20%D8%A7%D9%84%D9%88%D8%B2%D8%A7%D8%B1%D9%87.png?auth_key=1791122829-70983e0b353145a3b804341b229af8a4-0-fcc7a582b834bd1790247c1399ff1a0e" alt="ÿ¥ÿπÿßÿ± ÿßŸÑŸàÿ≤ÿßÿ±ÿ©">
        <h1>ŸÖÿ±ÿßÿ¨ÿπÿ© ÿπÿßŸÖÿ© ŸÑŸÑÿµŸÅ 3ŸÖ ŸÅ1 ÿßŸÑŸÑÿ∫ÿ© ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</h1>
        <p class="school-name">ÿßŸÑŸÖÿØÿ±ÿ≥ÿ© ÿßŸÑŸÖÿ™Ÿàÿ≥ÿ∑ÿ© ÿßŸÑÿ±ÿßÿ®ÿπÿ© ÿ®ÿßŸÑŸáŸÅŸàŸÅ</p>
    </div>

    <div class="mode-selection">
        <button class="mode-btn active" id="btn-exam" onclick="setMode('exam')">üìù Ÿàÿ∂ÿπ ÿßŸÑÿßÿÆÿ™ÿ®ÿßÿ±</button>
        <button class="mode-btn" id="btn-practice" onclick="setMode('practice')">üèãÔ∏è Ÿàÿ∂ÿπ ÿßŸÑÿ™ÿØÿ±Ÿäÿ®</button>
    </div>

    <div class="cards-container" id="cardsContainer">
        <!-- Cards injected via JS -->
    </div>

    <div class="controls">
        <button class="btn btn-reset" onclick="initQuiz()">üîÑ ÿ•ÿπÿßÿØÿ©</button>
        <button class="btn" id="finishBtn" onclick="finishQuiz()">‚úÖ ÿ•ŸÜŸáÿßÿ° Ÿàÿ™ÿµÿ≠Ÿäÿ≠</button>
    </div>

    <!-- Result Popup -->
    <div class="overlay" id="overlay"></div>
    <div class="stats-popup" id="resultPopup">
        <div class="score-circle" id="scoreCircle">0%</div>
        <h2 style="color:var(--text-main); margin-bottom:10px;">ÿßŸÑŸÜÿ™Ÿäÿ¨ÿ© ÿßŸÑŸÜŸáÿßÿ¶Ÿäÿ©</h2>
        <p id="scoreDetails" style="color:#64748b; margin-bottom:20px;"></p>
        <button class="btn" onclick="closePopup()">ÿ•ÿ∫ŸÑÿßŸÇ</button>
    </div>

    <script>
        // ================= SMART DATA STRUCTURE =================
        const quizData = [
            // --- ÿßŸÑÿ≥ÿ§ÿßŸÑ ÿßŸÑÿ£ŸàŸÑ (ÿ£) - ŸÖÿ≥ÿ™ŸÇŸÑÿ© ---
            {
                section: "ÿßŸÑÿ£ÿ≥ÿßŸÑŸäÿ® ÿßŸÑŸÑÿ∫ŸàŸäÿ©",
                type: "single",
                questions: [
                    { q: "ŸÜŸàÿπ ÿßŸÑÿ£ÿ≥ŸÑŸàÿ® ŸÅŸä: (ÿ™ÿßŸÑŸÑŸá ŸÑŸÖ Ÿäÿ™Ÿäÿ≥ÿ± Ÿáÿ∞ÿß ÿ•ŸÑÿß ÿ®ÿßŸÑÿπŸÑŸÖ):", options: ["ŸÇÿ≥ŸÖ", "ÿ¥ÿ±ÿ∑", "ÿ™ŸÅÿ∂ŸäŸÑ", "ÿ≠ÿßŸÑ"], a: "ŸÇÿ≥ŸÖ" },
                    { q: "ŸÜŸàÿπ ÿßŸÑÿ£ÿ≥ŸÑŸàÿ® ŸÅŸä: (ŸÖŸÉÿ© ŸÅÿ∂ŸÑŸâ ÿßŸÑŸÖÿØŸÜ):", options: ["ÿ™ŸÅÿ∂ŸäŸÑ", "ŸÇÿ≥ŸÖ", "ÿ¥ÿ±ÿ∑", "ÿ≠ÿßŸÑ"], a: "ÿ™ŸÅÿ∂ŸäŸÑ" }
                ]
            },
            
            // --- ÿßŸÑÿ≥ÿ§ÿßŸÑ ÿßŸÑÿ£ŸàŸÑ (ÿ®) - ŸÖÿ≥ÿ™ŸÇŸÑÿ© ---
            {
                section: "ÿßŸÑÿ•ÿπÿ±ÿßÿ®",
                type: "single",
                questions: [
                    { q: "ÿ•ÿπÿ±ÿßÿ® (ŸÖÿ¥ÿ¨ÿπŸäŸÜ) ŸÅŸä: ŸäŸÇŸÅ ŸÇÿßÿØÿ© ÿßŸÑŸàÿ∑ŸÜ ŸÖÿ¥ÿ¨ÿπŸäŸÜ:", options: ["ÿ≠ÿßŸÑ ŸÖŸÜÿµŸàÿ®ÿ© ÿ®ÿßŸÑŸäÿßÿ°", "ŸÖŸÅÿπŸàŸÑ ÿ®Ÿá ŸÖŸÜÿµŸàÿ®", "ÿ™ŸÖŸäŸäÿ≤ ŸÖŸÜÿµŸàÿ®", "ŸÅÿßÿπŸÑ ŸÖÿ±ŸÅŸàÿπ"], a: "ÿ≠ÿßŸÑ ŸÖŸÜÿµŸàÿ®ÿ© ÿ®ÿßŸÑŸäÿßÿ°" },
                    { q: "ÿ•ÿπÿ±ÿßÿ® (ÿ≠ÿ®ÿß) ŸÅŸä: ŸáŸÅÿ™ ÿßŸÑŸÇŸÑŸàÿ® ÿ•ŸÑŸâ ÿßŸÑŸÖŸÑŸÉ ÿ≥ŸÑŸÖÿßŸÜ ÿ≠ÿ®ÿß:", options: ["ÿ™ŸÖŸäŸäÿ≤ ŸÖŸÜÿµŸàÿ® ÿ®ÿßŸÑŸÅÿ™ÿ≠ÿ©", "ÿ≠ÿßŸÑ ŸÖŸÜÿµŸàÿ®ÿ©", "ŸÖŸÅÿπŸàŸÑ ŸÑÿ£ÿ¨ŸÑŸá", "ÿßÿ≥ŸÖ ŸÖÿ¨ÿ±Ÿàÿ±"], a: "ÿ™ŸÖŸäŸäÿ≤ ŸÖŸÜÿµŸàÿ® ÿ®ÿßŸÑŸÅÿ™ÿ≠ÿ©" }
                ]
            },

            // --- ÿßŸÑÿ≥ÿ§ÿßŸÑ ÿßŸÑÿ£ŸàŸÑ (ÿ¨-1) - ŸÜÿµ ÿ¥ÿπÿ±Ÿä 1 ---
            {
                section: "ÿßŸÑŸÜÿµŸàÿµ ÿßŸÑÿ¥ÿπÿ±Ÿäÿ© (1)",
                type: "group",
                context: "ŸÅÿ•ŸÜ Ÿäÿ£ŸÉŸÑŸàÿß ŸÑÿ≠ŸÖŸä ŸàŸÅÿ±ÿ™ ŸÑÿ≠ŸàŸÖŸáŸÖ ... Ÿàÿ•ŸÜ ŸäŸáÿØŸÖŸàÿß ŸÖÿ¨ÿØŸä ÿ®ŸÜŸäÿ™ ŸÑŸáŸÖ ŸÖÿ¨ÿØÿß\nŸàÿ•ŸÜ ÿ∂ŸäÿπŸàÿß ÿ∫Ÿäÿ®Ÿä ÿ≠ŸÅÿ∏ÿ™ ÿ∫ŸäŸàÿ®ŸáŸÖ ... Ÿàÿ•ŸÜ ŸáŸàŸàÿß ÿ∫ŸäŸä ŸáŸàŸäÿ™ ŸÑŸáŸÖ ÿ±ÿ¥ÿØÿß",
                questions: [
                    { q: "ŸÅŸä ÿßŸÑÿ®Ÿäÿ™ ÿßŸÑÿ£ŸàŸÑ ÿ¥ÿ®Ÿá ÿßŸÑÿ¥ÿßÿπÿ± ÿ£ÿ®ŸÜÿßÿ° ÿπŸÖŸá ÿ®ŸÄ:", options: ["ÿßŸÑŸàÿ≠Ÿàÿ¥ ÿßŸÑŸÖŸÅÿ™ÿ±ÿ≥ÿ©", "ÿßŸÑÿ≠ŸäŸàÿßŸÜÿßÿ™ ÿßŸÑÿ£ŸÑŸäŸÅÿ©", "ÿßŸÑÿ≠ŸÖÿßŸÖ", "ÿßŸÑÿ¨ŸÖŸÑ"], a: "ÿßŸÑŸàÿ≠Ÿàÿ¥ ÿßŸÑŸÖŸÅÿ™ÿ±ÿ≥ÿ©" },
                    { q: "ŸÅŸä ÿßŸÑÿ®Ÿäÿ™ ÿßŸÑÿ´ÿßŸÜŸä ÿ∂ÿØ ŸÉŸÑŸÖÿ© ( ÿ™ÿ∂ŸäŸäÿπ ):", options: ["ÿ≠ŸÅÿ∏", "ŸáŸÑÿßŸÉ", "ÿ±ÿ¥ÿØ", "ÿ∫Ÿäÿ®"], a: "ÿ≠ŸÅÿ∏" }
                ]
            },

            // --- ÿßŸÑÿ≥ÿ§ÿßŸÑ ÿßŸÑÿ£ŸàŸÑ (ÿ¨-2) - ŸÜÿµ ÿ¥ÿπÿ±Ÿä 2 ---
            {
                section: "ÿßŸÑŸÜÿµŸàÿµ ÿßŸÑÿ¥ÿπÿ±Ÿäÿ© (2)",
                type: "group",
                context: "ŸàŸÜÿØŸâ Ÿäÿ¨Ÿàÿ≤ ÿßŸÑÿ∫ÿßÿØŸäÿßÿ™ ŸÜŸàÿßŸÑŸá ... ŸÅÿ™ÿ±ÿßŸá Ÿäÿ∫ÿØŸÇ ŸÖÿß ŸäŸÜÿßŸÑ ŸàŸäÿ£ÿ±ÿ®\nÿ≠ÿ™Ÿâ ÿßÿ®ÿ™ÿ≥ÿßŸÖÿ™Ÿá ÿßŸÑÿ™Ÿä ÿπÿ±ŸÅÿ™ ÿ®Ÿá ... ÿ™Ÿáÿ® ÿßŸÑŸÉÿ®Ÿäÿ± ŸàŸÇÿßÿ±Ÿá Ÿàÿ™ÿ≠ÿ®ÿ®",
                questions: [
                    { q: "ŸÅŸä ÿßŸÑÿ®Ÿäÿ™ ÿßŸÑÿ£ŸàŸÑ ÿ¥ÿ®Ÿá ÿßŸÑÿ¥ÿßÿπÿ± ÿπÿ®ÿØ ÿßŸÑÿ±ÿ≠ŸÖŸÜ ÿßŸÑÿ≥ÿπÿØŸä ÿ®ŸÄ:", options: ["ÿßŸÑÿ≥ÿ≠ÿßÿ®ÿ©", "ÿßŸÑÿ≤ÿ±ÿπ", "ÿßŸÑŸÇŸÖÿ±", "ÿßŸÑÿ¨ÿ®ŸÑ"], a: "ÿßŸÑÿ≥ÿ≠ÿßÿ®ÿ©" },
                    { q: "ŸÅŸä ÿßŸÑÿ®Ÿäÿ™ ÿßŸÑÿ´ÿßŸÜŸä ÿ∂ÿØ ŸÉŸÑŸÖÿ© ( ÿ™Ÿáÿ® ):", options: ["ÿ™ÿ≥ŸÑÿ®", "ÿ™ÿπÿ∑Ÿä", "ÿ™ÿ≥ÿ±ÿπ", "ÿ™ŸÇÿ±ÿ£"], a: "ÿ™ÿ≥ŸÑÿ®" }
                ]
            },

            // --- ÿßŸÑÿ≥ÿ§ÿßŸÑ ÿßŸÑÿ´ÿßŸÜŸä: ÿ•ŸÖŸÑÿßÿ° ŸàŸÖÿ¥ÿ™ŸÇÿßÿ™ ŸàŸÜÿ≠Ÿà ---
            {
                section: "ÿßŸÑÿ•ŸÖŸÑÿßÿ°: ÿßŸÑÿ£ŸÑŸÅ ÿßŸÑŸÑŸäŸÜÿ©",
                type: "single",
                questions: [
                    { q: "ÿ™ŸÉÿ™ÿ® ÿßŸÑÿ£ŸÑŸÅ ÿßŸÑŸÑŸäŸÜÿ© ŸÅŸä ÿßŸÑŸÅÿπŸÑ ÿØÿπŸÄ...", options: ["ÿß", "Ÿâ", "ŸÄŸÄÿß", "ŸÄŸÄŸâ"], a: "ÿß" },
                    { q: "ÿ™ŸÉÿ™ÿ® ÿßŸÑÿ£ŸÑŸÅ ÿßŸÑŸÑŸäŸÜÿ© ŸÅŸä ÿßŸÑŸÅÿπŸÑ ( ŸÇÿ∂....) .", options: ["Ÿâ", "ÿß", "Ÿà", "Ÿä"], a: "Ÿâ" },
                    { q: "ÿ™ŸÉÿ™ÿ® ÿßŸÑÿ£ŸÑŸÅ ÿßŸÑŸÑŸäŸÜÿ© ŸÅŸä ÿßŸÑŸÅÿπŸÑ (ÿßÿ≥ÿ™ÿ≠Ÿä ....)", options: ["ÿß", "Ÿâ", "ÿ®", "ÿ¨"], a: "ÿß" },
                    { q: "ÿ™ŸÉÿ™ÿ® ÿßŸÑÿ£ŸÑŸÅ ÿßŸÑŸÑŸäŸÜÿ© ŸÅŸä ÿßŸÑŸÅÿπŸÑ ( ÿßÿ≥ÿ™ŸàŸÑ .... ) .", options: ["Ÿâ", "ÿß", "Ÿà", "ŸÄŸÄÿß"], a: "Ÿâ" }
                ]
            },
            {
                section: "ÿßŸÑŸÖÿ¥ÿ™ŸÇÿßÿ™ ŸàÿßŸÑÿ£Ÿàÿ≤ÿßŸÜ",
                type: "single",
                questions: [
                    { q: "ŸÑÿß ŸÖŸÉÿßŸÜ ŸÑŸÖÿ∫ÿ±ÿ∂ (ÿ≠ŸÇŸàÿØ). ŸÖÿß ÿ™ÿ≠ÿ™Ÿá ÿÆÿ∑:", options: ["ÿµŸäÿ∫ÿ© ŸÖÿ®ÿßŸÑÿ∫ÿ©", "ÿßÿ≥ŸÖ ŸÅÿßÿπŸÑ", "ÿßÿ≥ŸÖ ŸÖŸÅÿπŸàŸÑ", "ÿßÿ≥ŸÖ ÿ¢ŸÑÿ©"], a: "ÿµŸäÿ∫ÿ© ŸÖÿ®ÿßŸÑÿ∫ÿ©" },
                    { q: "ÿ•ŸÜ ÿ™ŸÉŸàŸÜŸàÿß (ÿµÿßŸÑÿ≠ŸäŸÜ). ŸÜŸàÿπ ÿßŸÑŸÖÿ¥ÿ™ŸÇ:", options: ["ÿßÿ≥ŸÖ ŸÅÿßÿπŸÑ", "ÿßÿ≥ŸÖ ŸÖŸÅÿπŸàŸÑ", "ÿµŸäÿ∫ÿ© ŸÖÿ®ÿßŸÑÿ∫ÿ©", "ÿßÿ≥ŸÖ ÿ™ŸÅÿ∂ŸäŸÑ"], a: "ÿßÿ≥ŸÖ ŸÅÿßÿπŸÑ" },
                    { q: "ŸÑŸà ÿ™ÿπŸÑŸÖŸàŸÜ ( ŸÑŸÇÿßÿ¶ŸÑ ) ŸÅÿπÿßŸÑ. ÿßŸÑŸÉŸÑŸÖÿ© ÿπŸÑŸâ Ÿàÿ≤ŸÜ:", options: ["ŸÅÿßÿπŸÑ", "ŸÖŸÅÿπŸàŸÑ", "ÿ£ŸÅÿπŸÑ", "ŸÖŸÅÿπÿßŸÑ"], a: "ŸÅÿßÿπŸÑ" },
                    { q: "ÿßŸÑÿπŸÑŸÖ ( ŸÖÿπÿ±ŸàŸÅ ) ÿßŸÑŸÉŸÑŸÖÿ© ÿπŸÑŸâ Ÿàÿ≤ŸÜ:", options: ["ŸÖŸÅÿπŸàŸÑ", "ŸÅÿßÿπŸÑ", "ÿ£ŸÅÿπŸÑ", "ŸÖŸÅÿπÿßŸÑ"], a: "ŸÖŸÅÿπŸàŸÑ" },
                    { q: "ŸÉŸÑ ŸÖŸàÿßÿ∑ŸÜ ( ÿπŸÑŸäŸÖ) ÿ®ÿØŸàÿ±Ÿá. ÿßŸÑŸÉŸÑŸÖÿ© ÿπŸÑŸâ Ÿàÿ≤ŸÜ:", options: ["ŸÅÿπŸäŸÑ", "ŸÅÿßÿπŸÑ", "ŸÖŸÅÿπŸàŸÑ", "ŸÖŸÅÿπÿßŸÑ"], a: "ŸÅÿπŸäŸÑ" },
                    { q: "ÿßÿ≥ŸÖ ÿßŸÑŸÅÿßÿπŸÑ ŸÖŸÜ ÿßŸÑŸÅÿπŸÑ ( ŸÜÿ¨ÿ≠ ):", options: ["ŸÜÿßÿ¨ÿ≠", "ŸÖŸÜÿ¨Ÿàÿ≠", "ÿ£ŸÜÿ¨ÿ≠", "ŸÜÿ¨Ÿäÿ≠"], a: "ŸÜÿßÿ¨ÿ≠" },
                    { q: "ÿßÿ≥ŸÖ ÿßŸÑŸÖŸÅÿπŸàŸÑ ŸÖŸÜ ÿßŸÑŸÅÿπŸÑ ( ÿ≥ŸÖÿ≠ ):", options: ["ŸÖÿ≥ŸÖŸàÿ≠", "ÿ≥ÿßŸÖÿ≠", "ÿ≥ŸÖŸäÿ≠", "ÿ£ÿ≥ŸÖÿ≠"], a: "ŸÖÿ≥ŸÖŸàÿ≠" }
                ]
            },
            {
                section: "ÿßŸÑŸÜÿ≠Ÿà (ÿßŸÑÿ™ŸÖŸäŸäÿ≤ ŸàÿßŸÑÿßÿ≥ÿ™ÿ´ŸÜÿßÿ° ŸàÿßŸÑÿ≠ÿßŸÑ)",
                type: "single",
                questions: [
                    { q: "ÿ™ÿµÿØŸÇ ÿßŸÑÿ∫ŸÜŸä ÿ®ÿµÿßÿπ (ŸÇŸÖÿ≠ÿß). ŸÜŸàÿπ ÿßŸÑÿ™ŸÖŸäŸäÿ≤:", options: ["ŸÖŸÅÿ±ÿØ", "ÿ¨ŸÖŸÑÿ©", "ŸÇŸäÿßÿ≥Ÿä", "ÿ≥ŸÖÿßÿπŸä"], a: "ŸÖŸÅÿ±ÿØ" },
                    { q: "ÿ≠ÿ∂ÿ± ÿßŸÑÿ∑ŸÑÿßÿ® ÿ•ŸÑÿß ÿ£ÿÆÿßŸÉ. ŸÜŸàÿπ ÿßŸÑÿßÿ≥ÿ™ÿ´ŸÜÿßÿ°:", options: ["ÿ™ÿßŸÖ ŸÖÿ´ÿ®ÿ™", "ÿ™ÿßŸÖ ŸÖŸÜŸÅŸä", "ŸÜÿßŸÇÿµ ŸÖŸÜŸÅŸä", "ŸÖŸÅÿ±ÿ∫"], a: "ÿ™ÿßŸÖ ŸÖÿ´ÿ®ÿ™" },
                    { q: "ÿßŸÑŸÜŸàÿ± ŸàŸáŸà (ŸÖŸÜÿ®ÿπÿ´) ÿ®ŸÇŸàÿ©. ŸÜŸàÿπ ÿßŸÑÿ≠ÿßŸÑ:", options: ["ÿ¨ŸÖŸÑÿ© ÿßÿ≥ŸÖŸäÿ©", "ŸÖŸÅÿ±ÿØ", "ÿ¨ŸÖŸÑÿ© ŸÅÿπŸÑŸäÿ©", "ÿ¥ÿ®Ÿá ÿ¨ŸÖŸÑÿ©"], a: "ÿ¨ŸÖŸÑÿ© ÿßÿ≥ŸÖŸäÿ©" },
                    { q: "( Ÿàÿ¨ÿßÿ°Ÿàÿß ÿ£ÿ®ÿßŸáŸÖ ÿπÿ¥ÿßÿ° Ÿäÿ®ŸÉŸàŸÜ ) ŸÜŸàÿπ ÿßŸÑÿ≠ÿßŸÑ:", options: ["ÿ¨ŸÖŸÑÿ© ŸÅÿπŸÑŸäÿ©", "ŸÖŸÅÿ±ÿØ", "ÿ¨ŸÖŸÑÿ© ÿßÿ≥ŸÖŸäÿ©", "ÿ¥ÿ®Ÿá ÿ¨ŸÖŸÑÿ©"], a: "ÿ¨ŸÖŸÑÿ© ŸÅÿπŸÑŸäÿ©" },
                    { q: "( ÿßÿ¥ÿ™ÿ±Ÿäÿ™ ŸÖÿ™ÿ±ÿß ŸÇŸÖÿßÿ¥ÿß ) ŸÜŸàÿπ ÿßŸÑŸÖŸÖŸäÿ≤:", options: ["ŸÖŸÑŸÅŸàÿ∏", "ŸÖŸÑÿ≠Ÿàÿ∏", "ŸÇŸäÿßÿ≥Ÿä", "ÿ≥ŸÖÿßÿπŸä"], a: "ŸÖŸÑŸÅŸàÿ∏" },
                    { q: "( ÿÆÿ™ŸÖÿ™ ÿ®ŸÜÿ™ ÿßŸÑÿ¥ÿßÿ∑ÿ¶ ÿßŸÑŸÇÿ±ÿ¢ŸÜ ÿ≠ŸÅÿ∏ÿß ) ŸÜŸàÿπ ÿßŸÑŸÖŸÖŸäÿ≤:", options: ["ŸÖŸÑÿ≠Ÿàÿ∏", "ŸÖŸÑŸÅŸàÿ∏", "ŸÇŸäÿßÿ≥Ÿä", "ÿ≥ŸÖÿßÿπŸä"], a: "ŸÖŸÑÿ≠Ÿàÿ∏" },
                    { q: "( ŸÑŸÖ Ÿäÿ≠ŸÅÿ∏ ÿßŸÑÿ∑ŸÑÿßÿ® ÿßŸÑŸÇÿµŸäÿØÿ© ÿ•ŸÑÿß ÿÆÿßŸÑÿØŸãÿß ) ÿ≠ŸÉŸÖ ÿßŸÑŸÜÿµÿ®:", options: ["ÿ¨ÿßÿ¶ÿ≤", "Ÿàÿßÿ¨ÿ®", "ŸÖŸÖÿ™ŸÜÿπ", "ÿ≠ÿ≥ÿ® ŸÖŸàŸÇÿπŸá"], a: "ÿ¨ÿßÿ¶ÿ≤" },
                    { q: "Ÿäÿ¨ÿ≠ÿØ ÿßŸÑŸÜÿßÿ≥ ÿßŸÑŸÜÿπŸÖÿ© ÿ•ŸÑÿß (ÿßŸÑŸÖÿ§ŸÖŸÜ). ÿßŸÑÿπŸÑÿßŸÖÿ© ÿßŸÑÿ•ÿπÿ±ÿßÿ®Ÿäÿ©:", options: ["ÿßŸÑŸÅÿ™ÿ≠ÿ©", "ÿßŸÑÿ∂ŸÖÿ©", "ÿßŸÑŸÉÿ≥ÿ±ÿ©", "ÿßŸÑÿ≥ŸÉŸàŸÜ"], a: "ÿßŸÑŸÅÿ™ÿ≠ÿ©" },
                    { q: "ÿßÿ±ÿ™ŸÅÿπ ÿßŸÑÿπÿßŸÑŸÖ (ŸÇÿØÿ±ÿß). ÿßŸÑÿπŸÑÿßŸÖÿ© ÿßŸÑÿ•ÿπÿ±ÿßÿ®Ÿäÿ©:", options: ["ÿßŸÑŸÅÿ™ÿ≠ÿ©", "ÿßŸÑÿ∂ŸÖÿ©", "ÿßŸÑŸÉÿ≥ÿ±ÿ©", "ÿßŸÑÿ≥ŸÉŸàŸÜ"], a: "ÿßŸÑŸÅÿ™ÿ≠ÿ©" },
                    { q: "ŸäŸÇŸÅ ŸÇÿßÿØÿ© ÿßŸÑŸàÿ∑ŸÜ (ŸÖÿ¥ÿ¨ÿπŸäŸÜ). ÿßŸÑÿπŸÑÿßŸÖÿ© ÿßŸÑÿ•ÿπÿ±ÿßÿ®Ÿäÿ©:", options: ["ÿßŸÑŸäÿßÿ°", "ÿßŸÑŸÅÿ™ÿ≠ÿ©", "ÿßŸÑŸÉÿ≥ÿ±ÿ©", "ÿßŸÑÿ∂ŸÖÿ©"], a: "ÿßŸÑŸäÿßÿ°" }
                ]
            },
            {
                section: "ÿµÿ≠ ÿ£ŸÖ ÿÆÿ∑ÿ£",
                type: "single",
                questions: [
                    { q: "( ŸäŸÖŸäŸÜ ÿßŸÑŸÑŸá ŸÑÿ£ÿπÿ∑ŸäŸÜ ÿßŸÑÿ∑ÿ±ŸäŸÇ ÿ≠ŸÇŸá ) ŸÖŸÜ ÿµŸäÿ∫ ÿßŸÑŸÇÿ≥ŸÖ", options: ["ÿµÿ≠", "ÿÆÿ∑ÿ£"], a: "ÿµÿ≠" },
                    { q: "( ŸÖÿß ÿ™ÿ≤ÿ±ÿπŸá ÿßŸÑŸäŸàŸÖ ÿ™ÿ≠ÿµÿØŸá ÿ∫ÿØÿß ) ÿ£ÿ≥ŸÑŸàÿ® ÿ¥ÿ±ÿ∑", options: ["ÿµÿ≠", "ÿÆÿ∑ÿ£"], a: "ÿµÿ≠" },
                    { q: "( ÿßŸÑÿ±Ÿäÿßÿ∂ ŸÉÿ®ÿ±Ÿâ ÿßŸÑŸÖÿØŸÜ ) ÿ£ÿ≥ŸÑŸàÿ® ÿ™ŸÅÿ∂ŸäŸÑ", options: ["ÿµÿ≠", "ÿÆÿ∑ÿ£"], a: "ÿµÿ≠" },
                    { q: "ÿ™ÿπÿØ (ŸÑŸà) ŸÖŸÜ ÿ£ÿØŸàÿßÿ™ ÿßŸÑÿ¥ÿ±ÿ∑ ÿßŸÑÿ™Ÿä ÿ™ŸÅŸäÿØ ÿßŸÑÿ≤ŸÖÿßŸÜ", options: ["ÿÆÿ∑ÿ£", "ÿµÿ≠"], a: "ÿÆÿ∑ÿ£" },
                    { q: "Ÿäÿµÿßÿ∫ ÿßÿ≥ŸÖ ÿßŸÑÿ™ŸÅÿ∂ŸäŸÑ ŸÖŸÜ ÿßŸÑŸÅÿπŸÑ ÿßŸÑÿ´ŸÑÿßÿ´Ÿä ÿßŸÑŸÖÿ´ÿ®ÿ™ ÿßŸÑŸÖÿ®ŸÜŸä ŸÑŸÑŸÖÿπŸÑŸàŸÖ", options: ["ÿµÿ≠", "ÿÆÿ∑ÿ£"], a: "ÿµÿ≠" },
                    { q: "ŸÖŸÜ ŸÇŸàÿßÿπÿØ ÿÆÿ∑ ÿßŸÑÿ±ŸÇÿπÿ© ŸÉÿ™ÿßÿ®ÿ© ÿßŸÑÿ≠ÿ±ŸàŸÅ ( ŸáŸÄ ) ÿ™ÿ≠ÿ™ ÿßŸÑÿ≥ÿ∑ÿ±", options: ["ÿÆÿ∑ÿ£", "ÿµÿ≠"], a: "ÿÆÿ∑ÿ£" },
                    { q: "( ÿ®Ÿäÿ™ ÿßŸÑŸÑŸá ÿ£ŸÇÿØÿ≥ ÿßŸÑÿ®ŸäŸàÿ™ ) ŸÖÿß ÿ™ÿ≠ÿ™Ÿá ÿÆÿ∑ ÿßŸÑŸÖŸÅÿ∂ŸÑ", options: ["ÿµÿ≠", "ÿÆÿ∑ÿ£"], a: "ÿµÿ≠" },
                    { q: "ÿ•ÿ∞ÿß ÿØÿÆŸÑ ÿ≠ÿ±ŸÅ ÿßŸÑÿ¨ÿ± (ŸÖŸÜ) ÿπŸÑŸâ ( ŸÖŸéŸÜ ) ÿ™ŸÉÿ™ÿ® ( ŸÖŸÖŸÜ )", options: ["ÿµÿ≠", "ÿÆÿ∑ÿ£"], a: "ÿµÿ≠" },
                    { q: "ÿßŸÑŸÅÿπŸÑ ÿßŸÑŸÖŸÜÿ™ŸáŸä ÿ®ÿ£ŸÑŸÅ ŸÑŸäŸÜÿ© ÿ£ÿµŸÑŸáÿß ŸàÿßŸà ŸäŸÉÿ™ÿ® ÿ®ÿ£ŸÑŸÅ ŸÖŸÇÿµŸàÿ±ÿ©", options: ["ÿÆÿ∑ÿ£", "ÿµÿ≠"], a: "ÿÆÿ∑ÿ£" },
                    { q: "( ŸäŸÑÿπÿ® ÿßŸÑÿ£ÿ∑ŸÅÿßŸÑ ŸàŸáŸÖ ŸÖÿ≥ÿ±Ÿàÿ±ŸäŸÜ ) ÿßŸÑŸàÿßŸà ŸáŸä ŸàÿßŸà ÿßŸÑÿπÿ∑ŸÅ", options: ["ÿÆÿ∑ÿ£", "ÿµÿ≠"], a: "ÿÆÿ∑ÿ£" }
                ]
            },

            // --- ÿßŸÑÿ≥ÿ§ÿßŸÑ ÿßŸÑÿ±ÿßÿ®ÿπ - ŸÇÿ∑ÿπÿ© ŸÅŸáŸÖ Ÿàÿßÿ≥ÿ™Ÿäÿπÿßÿ® ---
            {
                section: "ÿßŸÑŸÅŸáŸÖ ŸàÿßŸÑÿßÿ≥ÿ™Ÿäÿπÿßÿ®",
                type: "group",
                context: "ÿ•ŸÜ ÿßŸÑŸàÿßÿ¨ÿ® ÿπŸÑŸâ ŸÉŸÑ ŸÖŸàÿßÿ∑ŸÜ ÿ¥ÿ±ŸäŸÅ ÿÆÿßÿµÿ© ÿßŸÑÿ¥ÿ®ÿßÿ® ÿ£ŸÜ Ÿäÿ≠ÿ∞ÿ± ŸÖŸÜ ÿßŸÑÿ¥ÿßÿ¶ÿπÿßÿ™ ÿßŸÑŸÖÿ∫ÿ±ÿ∂ÿ© ÿå ŸÑÿ¶ŸÑÿß ŸäŸÉŸàŸÜ ŸÖÿπŸàŸÑ ŸáÿØŸÖ ŸÑÿ£ŸÖÿ™Ÿá Ÿàÿ≥ÿ®ÿ® ŸÅŸä ÿ™ŸÅÿ±ŸÇ ŸÉŸÑŸÖÿ™Ÿáÿß ÿå ŸàŸÇÿØ ŸÜŸáŸâ ÿßŸÑÿ±ÿ≥ŸàŸÑ ÿπŸÑŸäŸá ÿßŸÑÿµŸÑÿßÿ© ŸàÿßŸÑÿ≥ŸÑÿßŸÖ ÿπŸÜ ŸÇŸäŸÑ ŸàŸÇÿßŸÑ ŸàŸÉÿ´ÿ±ÿ© ÿßŸÑÿ≥ÿ§ÿßŸÑ Ÿàÿ•ÿ∂ÿßÿπÿ© ÿßŸÑŸÖÿßŸÑ .",
                questions: [
                    { q: "ŸÖÿß ÿßŸÑŸàÿßÿ¨ÿ® ÿπŸÑŸâ ŸÉŸÑ ŸÖŸàÿßÿ∑ŸÜ ÿ¥ÿ±ŸäŸÅÿü", options: ["ÿßŸÑÿ≠ÿ∞ÿ± ŸÖŸÜ ÿßŸÑÿ¥ÿßÿ¶ÿπÿßÿ™", "ŸÜÿ¥ÿ± ÿßŸÑÿ£ÿÆÿ®ÿßÿ±", "ÿ™ÿ¨ÿßŸáŸÑ ŸÉŸÑ ÿ¥Ÿäÿ°", "ŸÉÿ´ÿ±ÿ© ÿßŸÑÿ≠ÿØŸäÿ´"], a: "ÿßŸÑÿ≠ÿ∞ÿ± ŸÖŸÜ ÿßŸÑÿ¥ÿßÿ¶ÿπÿßÿ™" },
                    { q: "ÿπŸÑŸÑŸä Ÿàÿ¨Ÿàÿ® ÿßŸÑÿ≠ÿ∞ÿ± ŸÖŸÜ ÿßŸÑÿ¥ÿßÿ¶ÿπÿßÿ™:", options: ["ŸÑÿ¶ŸÑÿß ŸäŸÉŸàŸÜ ŸÖÿπŸàŸÑ ŸáÿØŸÖ ŸÑÿ£ŸÖÿ™Ÿá", "ŸÑÿ£ŸÜŸáÿß ŸÖÿ∂Ÿäÿπÿ© ŸÑŸÑŸàŸÇÿ™", "ŸÑÿ≤ŸäÿßÿØÿ© ÿßŸÑŸÖÿπŸÑŸàŸÖÿßÿ™", "ŸÑŸÑÿ™ÿ≥ŸÑŸäÿ©"], a: "ŸÑÿ¶ŸÑÿß ŸäŸÉŸàŸÜ ŸÖÿπŸàŸÑ ŸáÿØŸÖ ŸÑÿ£ŸÖÿ™Ÿá" },
                    { q: "ÿπÿØÿØŸä ÿßŸÑÿ£ŸÖŸàÿ± ÿßŸÑÿ™Ÿä ŸÜŸáŸâ ÿπŸÜŸáÿß ÿßŸÑÿ±ÿ≥ŸàŸÑ ŸÅŸä ÿßŸÑŸÇÿ∑ÿπÿ©:", options: ["ŸÇŸäŸÑ ŸàŸÇÿßŸÑ ŸàŸÉÿ´ÿ±ÿ© ÿßŸÑÿ≥ÿ§ÿßŸÑ", "ÿßŸÑŸÜŸàŸÖ ÿßŸÑŸÖÿ™ÿ£ÿÆÿ±", "ÿßŸÑÿ•ÿ≥ÿ±ÿßŸÅ ŸÅŸä ÿßŸÑÿ∑ÿπÿßŸÖ", "ÿßŸÑÿ∂ÿ≠ŸÉ ÿßŸÑŸÉÿ´Ÿäÿ±"], a: "ŸÇŸäŸÑ ŸàŸÇÿßŸÑ ŸàŸÉÿ´ÿ±ÿ© ÿßŸÑÿ≥ÿ§ÿßŸÑ" },
                    { q: "ÿßŸÑŸÅŸÉÿ±ÿ© ÿßŸÑŸÖŸÜÿßÿ≥ÿ®ÿ© ŸÑŸÑŸÜÿµ ÿßŸÑÿ≥ÿßÿ®ŸÇ:", options: ["Ÿàÿßÿ¨ÿ® ÿßŸÑŸÖŸàÿßÿ∑ŸÜ ÿ™ÿ¨ÿßŸá Ÿàÿ∑ŸÜŸá", "ÿ£ŸáŸÖŸäÿ© ÿßŸÑŸÖÿßŸÑ", "ÿ¢ÿØÿßÿ® ÿßŸÑÿ≠ÿØŸäÿ´", "ŸÖÿÆÿßÿ∑ÿ± ÿßŸÑÿ∑ÿ±ŸäŸÇ"], a: "Ÿàÿßÿ¨ÿ® ÿßŸÑŸÖŸàÿßÿ∑ŸÜ ÿ™ÿ¨ÿßŸá Ÿàÿ∑ŸÜŸá" }
                ]
            }
        ];

        let currentMode = 'exam';
        let userAnswers = {}; // { 'groupIndex-questionIndex': 'value' }

        function setMode(mode) {
            currentMode = mode;
            document.getElementById('btn-exam').classList.toggle('active', mode === 'exam');
            document.getElementById('btn-practice').classList.toggle('active', mode === 'practice');
            document.getElementById('finishBtn').style.display = mode === 'practice' ? 'none' : 'block';
            initQuiz();
        }

        // Fisher-Yates Shuffle Function
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function initQuiz() {
            const container = document.getElementById('cardsContainer');
            container.innerHTML = '';
            userAnswers = {};
            document.getElementById('overlay').style.display = 'none';
            document.getElementById('resultPopup').style.display = 'none';

            quizData.forEach((block, groupIdx) => {
                
                if (block.type === 'group') {
                    const card = document.createElement('div');
                    card.className = 'card';
                    card.innerHTML = `
                        <div class="section-badge">${block.section}</div>
                        <div class="context-box">${block.context}</div>
                    `;

                    block.questions.forEach((q, qIdx) => {
                        const qId = `${groupIdx}-${qIdx}`;
                        
                        // Copy options and shuffle them
                        const shuffledOptions = shuffleArray([...q.options]);

                        const btnsHtml = shuffledOptions.map(opt => 
                            `<button class="option-btn" onclick="selectAnswer('${qId}', '${opt}', '${q.a}', this)">${opt}</button>`
                        ).join('');

                        card.innerHTML += `
                            <div class="sub-question" id="subq-${qId}">
                                <div class="question-text">${qIdx + 1}. ${q.q}</div>
                                <div class="options-grid" id="opts-${qId}">
                                    ${btnsHtml}
                                </div>
                                <div class="feedback-msg" id="feedback-${qId}"></div>
                            </div>
                        `;
                    });
                    container.appendChild(card);

                } else {
                    const card = document.createElement('div');
                    card.className = 'card';
                    card.innerHTML = `<div class="section-badge">${block.section}</div>`;
                    
                    block.questions.forEach((q, qIdx) => {
                        const qId = `${groupIdx}-${qIdx}`;

                        // Copy options and shuffle them
                        const shuffledOptions = shuffleArray([...q.options]);

                        const btnsHtml = shuffledOptions.map(opt => 
                            `<button class="option-btn" onclick="selectAnswer('${qId}', '${opt}', '${q.a}', this)">${opt}</button>`
                        ).join('');

                        card.innerHTML += `
                            <div class="sub-question" id="subq-${qId}">
                                <div class="question-text">${qIdx + 1}. ${q.q}</div>
                                <div class="options-grid" id="opts-${qId}">
                                    ${btnsHtml}
                                </div>
                                <div class="feedback-msg" id="feedback-${qId}"></div>
                            </div>
                        `;
                    });
                    container.appendChild(card);
                }
            });
        }

        function selectAnswer(qId, value, correctVal, btnElement) {
            const feedbackEl = document.getElementById(`feedback-${qId}`);
            const parent = document.getElementById(`opts-${qId}`);

            Array.from(parent.children).forEach(b => {
                b.classList.remove('selected');
                if (currentMode === 'exam') {
                    b.classList.remove('correct-ans', 'wrong-ans'); 
                }
            });

            btnElement.classList.add('selected');
            userAnswers[qId] = value;

            if (currentMode === 'practice') {
                if (value === correctVal) {
                    btnElement.classList.add('correct-ans');
                    feedbackEl.style.display = 'block';
                    feedbackEl.style.backgroundColor = '#d1fae5';
                    feedbackEl.style.color = 'var(--correct-color)';
                    feedbackEl.innerText = '‚úÖ ÿ•ÿ¨ÿßÿ®ÿ© ÿµÿ≠Ÿäÿ≠ÿ©';
                } else {
                    btnElement.classList.add('wrong-ans');
                    feedbackEl.style.display = 'block';
                    feedbackEl.style.backgroundColor = '#fee2e2';
                    feedbackEl.style.color = 'var(--incorrect-color)';
                    feedbackEl.innerText = '‚ùå ÿ•ÿ¨ÿßÿ®ÿ© ÿÆÿßÿ∑ÿ¶ÿ©';
                }
            } else {
                feedbackEl.style.display = 'none';
            }
        }

        function finishQuiz() {
            let score = 0;
            let totalQuestions = 0;

            quizData.forEach((block, groupIdx) => {
                block.questions.forEach((q, qIdx) => {
                    totalQuestions++;
                    const qId = `${groupIdx}-${qIdx}`;
                    const feedbackEl = document.getElementById(`feedback-${qId}`);
                    const userChoice = userAnswers[qId];
                    const parent = document.getElementById(`opts-${qId}`);

                    Array.from(parent.children).forEach(btn => {
                        if (btn.innerText === q.a) {
                            btn.classList.add('correct-ans');
                        } else if (btn.innerText === userChoice && userChoice !== q.a) {
                            btn.classList.add('wrong-ans');
                        }
                    });

                    if (userChoice === q.a) {
                        score++;
                        feedbackEl.style.color = 'var(--correct-color)';
                        feedbackEl.innerText = '‚úÖ ÿ•ÿ¨ÿßÿ®ÿ© ÿµÿ≠Ÿäÿ≠ÿ©';
                        feedbackEl.style.backgroundColor = '#d1fae5';
                    } else {
                        feedbackEl.style.color = 'var(--incorrect-color)';
                        feedbackEl.innerText = userChoice ? `‚ùå ÿ•ÿ¨ÿßÿ®ÿ™ŸÉ: ${userChoice}` : '‚ùå ŸÑŸÖ Ÿäÿ™ŸÖ ÿßŸÑÿ≠ŸÑ';
                        feedbackEl.style.backgroundColor = '#fee2e2';
                    }
                    feedbackEl.style.display = 'block';
                });
            });

            const percent = Math.round((score / totalQuestions) * 100);
            document.getElementById('scoreCircle').innerText = `${percent}%`;
            document.getElementById('scoreDetails').innerText = `ÿ£ÿ¨ÿ®ÿ™ ÿπŸÑŸâ ${score} ŸÖŸÜ ÿ£ÿµŸÑ ${totalQuestions} ÿ≥ÿ§ÿßŸÑ ÿ®ÿ¥ŸÉŸÑ ÿµÿ≠Ÿäÿ≠.`;
            
            document.getElementById('overlay').style.display = 'block';
            document.getElementById('resultPopup').style.display = 'block';
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function closePopup() {
            document.getElementById('overlay').style.display = 'none';
            document.getElementById('resultPopup').style.display = 'none';
        }

        initQuiz();

    </script>
</body>
</html>
